# PHASTA Version 1.5 Input File
#
#  Basic format is
#
#    Key Phrase  :  Acceptable Value (integer, double, logical, or phrase
#                                     list of integers, list of doubles )
#

# To find the Key Phrases, first look in input.config.  There you will
# find the default values for everything that is allowed to have a
# default. Some things are not allowed to default and must be entered
# in this file.  In most cases, the acceptable inputs also appear in
# the input.config file. To add acceptable inputs you should only have
# to modify:

#     input_fform.cpp :which matches the string and translates it to the 
#                    parameter change. If it is a new parameter, you must
#                    modify:
#
#                      common.h (to carry new parameter through code)
#                      common_c.h (to carry the parameter from C to Fortran)
#     
#
# In case it is not clear by now, # allows you to comment either from the 
# beginning of the line or to the right as shown below.
#
SOLUTION CONTROL 
{
     Equation of State: Incompressible     # sets ipress=-1 matflag(1,n) 
     Number of Timesteps: 1000             # replaces nsteps(1) (ntseq wired =1)
     Time Step Size: 4.0E-5             # Delt(1)  ! Based on local CFL = 0.5 (mean would be around 0.17)
     Time Step Based on Maximum CFL: False # iflag_cfl_dt
     Maximum CFL Number Allowed: 1.0
#    Beginning Time:  -0.1                 # timestart
     Bubble Tracking: Enable     # Type 'Enable' to use bubble tracking capability
     Bubble Tracking Epsilon: 1.4594E-04  #epsilonBT with absolute value
     Solve Level Set : 2                   # =>iLSet
     Coalescence Control: Active              #Type 'Active' to implement #coalcon
     Coalescence Contorl Inverse Surface Tension: 12.0
     Coalescence Time Control: Deactive
     Number of Estimated Coalescence Events: 20  #2 is the Default value #coalest
     Bubble Radius for Coalescence Control: 8.105000E-04 #bubrad
     Turbulence Model:  DNS-WallFunc  
}

MATERIAL PROPERTIES
{
     Viscosity: 8.585E-05 1.96512E-05       # fills datmat (2 values REQUIRED if iLset=1) ! Re = 180 case parameters
     Density: 712.22 46.1678                   # ditto
     Scalar Diffusivity: 0.0 0.0                # fills scdiff(1:nsclrS)
     Body Force Option: Vector
     Body Force Pressure Gradient:  7029.15 0.0 0.0  # 5.9173
     Body Force: -9.8 0.0 0.0                    # (datmat(i,5,n),i=1,nsd)               # Gravity will go here
     Surface Tension Option: Yes                # isurf=1
     Inverse Surface Tension:  20    #13.7                        # 1/sigma !
     Repellant Force Bubble Radius: 0.015  #0.0005
     Ramp Properties: No                     # Turns on/off the ramping of the density and viscosity
#     Target Viscosity: 1.96512E-05   #7.5943822E-5              # Target second phase viscosity # air/water
#     Target Density:   46.1678    #0.0493665                    #                       density  # air/water
#     Ramp Start Time : 0.0              # Time Step when ramping will start / was started
#     Ramp Stop Time  : 0.005             # Time Step when ramping target values will be achieved
}

OUTPUT CONTROL
{
     Meshing Tools Used: 0                      # 1: Chef; 0: regular NSpre
     Number of Timesteps between Restarts: 100    # replaces nout/ntout
     Print Statistics: False                      # False=> ioform=1, True=> ioform=2
     Print Error Indicators: False                # F ierrcalc = 0, T ierrcalc = 1
#     Surface ID for Integrated Mass: 30  # isrfIM
#     Number of Force Surfaces: 2         # nsrfCM
#     Surface ID's for Force Calculation: 1 2   # nreadlist(j),j=1,nsrfCM
}

LINEAR SOLVER
{
     Solver Type: ACUSIM                           # iprjFlag=0 ipresPrjFlag=0
     Number of Krylov Vectors per GMRES Sweep: 120           # replaces Kspace
     Tolerance on Momentum Equations: 1.0E-5   #0.01             # epstol(1)
     Tolerance on Continuity Equations: 1.0E-04            # epstol(7)
     Tolerance on memLS NS Solver: 0.1                 # epstol(8)
     Number of Velocity Projection Vectors: 20         #nPrjs
     Scalar 1 Solver Tolerance: 1.0E-5   # 0.001
     Scalar 2 Solver Tolerance: 1.0E-8   # 0.001
     Tolerance on ACUSIM Pressure Projection: 1.0E-5 #0.01            # prestol
     Minimum Number of Iterations per Nonlinear Iteration: 10  # minIters
     Maximum Number of Iterations per Nonlinear Iteration: 40 # 200  # maxIters
}

DISCRETIZATION CONTROL
{
     Basis Function Order: 1                 # ipord
     Time Integration Rule: Second Order    # Second Order sets rinf next
     Time Integration Rho Infinity: 1.0    # rinf(1) Only used for 2nd order
#      Time Integration Rule: First Order    # Second Order sets rinf next
#     Time Integration Rho Infinity:-1     # rinf(1) Only used for 2nd order
     Include Viscous Correction in Stabilization: True     # if p=1 idiff=1
                                                           # if p=2 idiff=2  
#     Tau Matrix: Diagonal-Compressible         #itau=3
     Quadrature Rule on Interior: 2           #int(1)
     Quadrature Rule on Boundary: 2           #intb(1)
#     Lumped Mass Fraction on Left-hand-side: 1.0           # flmpl
#     Lumped Mass Fraction on Right-hand-side: 1.0          # flmpr
#     Tau Matrix: Diagonal-Franca               #itau=1
     Tau Time Constant: 8.                      #dtsfct ! Alisa's value
     Tau Time Constant for Scalars: 0.001        #dtsfctsclr
     Tau C Scale Factor: 0.1                   # taucfct  best value depends 
     Scalar Discontinuity Capturing: 1 2       #Sets DC=1 on second scalar 
}

TURBULENCE MODELING PARAMETERS  
{ 
        Turbulence Wall Model Type: Slip Velocity
}

LEVEL SET MODELING PARAMETERS  
{
        Number of Elements Across Interface: 1.4594E-04   #1.8*dx  #epsilon_ls
        Number of Elements Across Interface for Redistancing: 9.729E-05 #1.2*dx #a little higher than 0.0310 epsilon_lsd
        Use spatial varying epsilon_ls: 0  #i_spat_var_eps_flag: 0(off), 1(vol), 2(edge)
#
        Apply Volume Constraint: True   #ivconstraint=0
        Explicit Solve for Scalar 1 Field: 0 #iSolvLSSclr1 (0-implicit, 1-explicit)
        Explicit Solve for Redistance Field: 1 #iSolvLSSclr2 (0-implicit, 1-explicit)
        Pseudo Time step for Redistancing: 5.403E-06 #1750 #dtlset was 0.00005
        Base pseudo time step for redistancing on CFL number: 0.75  #65 #dtlset_cfl & i_dtlset_cfl, only active if non-zero
        Adjust Redistance Velocity to Satisfy CFL Limit: 0.0 #AdjRedistVelCFL (0-off, nonzero-on)
        Redistance loop: True      #i_redist_loop_flag
        Tolerance for redistance loop: 1.0E-8       #redist_toler was 1e-19 (now 1e-19)
        Maximum number of redistance iterations: 18  #i_redist_max_iter
#
        Check proximity of interface to large elements: False    #i_check_prox = 1 (True), 0 (False)
        Check proximity interface buffer thickness: 0.040       #r_int_buffer
        Check proximity maximum element size: 0.040             #r_int_elem_size
        Output level set gradient: False                #i_gradphi (=0 for False, =1 for True)
        Target Constant Void Fraction : 0.010
        Void Fraction Control Coefficient: 1.0      #vfcontrcoeff, for Jun's vf control
        Use Void Fraction Control Coefficient Cap: 0 #iuse_vfcont_cap, 1 for yes, 0 for no
        Void Fraction Control Coefficient Cap: 0.00125  #C_int_cap, interface vel adjustment coefficient cap
}

STEP SEQUENCE 
{
#     Step Construction: 0 1 0 1 
#       Step Construction: 0 1 10 11 0 1 10 11 20 21
      Step Construction: 0 1 10 11 0 1 10 11 0 1 10 11 20 21
#      Step Construction: 0 10 1 11 0 10 1 11 0 10 1 11 20 21
}


